<div class="row">
<% if current_user && ((@lesson.instructor && current_user == @lesson.instructor.user) || current_user.user_type == "Snow Schoolers Employee") %>
  
  <% @lesson.report_card = ReportCard.new unless @lesson.report_card %>
  
  <%= semantic_form_for @lesson.report_card do |f| %>

    <% @lesson.students.each do |student| %>
      <h3 class="student-name"><%= student.name %> (age <%= student.age_range %>)</h3>
      <ul>
        <li>
            <h3 class="italic">Before the lesson, they were a <%=student.most_recent_level %></h3>
        </li>
      </ul>

  <%= f.inputs do %>
    <%= f.input :student_id %>
    <%= f.input :lesson_id %>
    <%= f.input :instructor_id %>
    <%= f.input :attitude_grade %>
    <%= f.input :safety_grade %>
    <%= f.input :effort_grade %>
    <%= f.input :ability_level %>
    <%= f.input :activty %>
    <%= f.input :qualitative_feeback %>
    <%= f.input :balance %>
    <%= f.input :edge_control %>
    <%= f.input :pressure_control %>
    <%= f.input :rotary_control %>
  <% end %>


<%= f.inputs do %>
    <div class='row'>
          <h3 class="underline">Student's effort & attitude:</h3>
            <%= f.select :effort_grade,
              ["Excellent","Good","Okay","Needs Improvement"], {}, {class: 'form-control ability-level', required:true,
               include_blank: "", label: false} %>              
    </div>

    <div class='row'>
          <h3 class="underline">Skills & exercises we learned today:</h3>
            <input type="checkbox" id="selectAllSnowboardLevels" class="bold" value="selectAll"> Select / De-select All<br/><br/>
            <%= f.collection_check_boxes :skills_practiced_ids, Skill.where(ability_level:@lesson.levels_range), :id, :name do |skill| %>
              <div class="collection-check-box">
                <%= skill.check_box(class: 'snowboard-checkbox') %>
                <%= skill.label %>
              </div>
            <% end %>
    </div>

<!--     <div class='row'>
          <h3 class="underline">Skills & exercises to focus on in next lesson:</h3>
            <input type="checkbox" id="selectAllSnowboardLevels" class="bold" value="selectAll"> Select / De-select All<br/><br/>
            <%= f.collection_check_boxes :skills_recommended, Skill.where(ability_level:@lesson.levels_range), :id, :name do |skill| %>
              <div class="collection-check-box">
                <%= skill.check_box(class: 'snowboard-checkbox') %>
                <%= skill.label %>
              </div>
            <% end %>
    </div>
 -->
    <div class='row'>
            <h3>After today's lesson, their level is: </h3>
            <%= f.select :ability_level,
              ["Level 1 - First-timer",
              "Level 2 - Green Bean - can safely stop on beginner terrain.",
              "Level 3 - Green Machine - can turn in both directions.",
              "Level 4 - Blue Beginner - can link turns with moderate speed.",
              "Level 5 - Blue Boss - mostly parallel turns.",
              "Level 6 - Parallel Pro",
              "Level 7 - Basic Black",
              "Level 8 - Mogul Master",
              "Level 9 - Professor of Off-Piste"], {}, {class: 'form-control ability-level', required:true,
               include_blank: "Approximately what level of ability is the student?", label: false} %>              
    </div>

    <hr class="deposit-hr-navy">

<% if current_user %>
<%= f.input :requester_id, as: :hidden, input_html: { value: current_user.id } %>
<% end %>

<% end %>


    <% end %>


  <div class="col-md-12">
    <label><b> Other Feedback for the Lesson as a Whole</b></label>
    <%= f.input :qualitative_feeback, as: :text, input_html: { required:true }, placeholder: "Describe each students current ability level and progress made. What should they continue to focus on?", class: "feedback-for-student" , label:false %>

  </div>
  <div class="col-md-12">
    <%= f.submit "Submit Feedback", class: "btn btn-success" %>
  </div>
  <% end %>
<% elsif current_user.nil? %>
  <h3>
    <a href="#" class="btn btn-default" data-toggle="modal" data-target="#loginModal">Log in to update this lesson.</a>
  </h3>
<% else %>
  <div class="col-md-6">
    <h4 class="alert-warning  ">
      Waiting for instructor to confirm lesson start and end times.
    </h4>
  </div>
<% end %>
</div>
<hr>
