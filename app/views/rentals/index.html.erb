<div id="middle" class="container">
  <div class="white">

    <h1>Rentals</h1>

    <% @lessons.each do |lesson| %>

    <p class='text-left'>
       Rentals for <%= lesson.requester_name %> on <%= lesson.date.strftime("%A %b %e, %Y") %> <%= link_to lesson.product.name, lesson_path(lesson.id), class: 'btn btn-primary' %> <!-- (Lesson ID: <%= lesson.id %>) -->
    </p>


    <table class="instructors-table">
      <thead>
        <tr>
          <% if current_user && current_user.email == "brian@snowschoolers.com" || current_user.user_type == "Snow Schoolers Employee" %>
          <th>Rental ID</th>
          <th>GB Identifier</th>
          <% end %>
          <th>Student Name</th>
          <th>Equipment Type</th>
          <th>Size</th>
          <th>Status</th>
          <th>Other Notes</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% lesson.rentals.each do |rental| %>
        <tr>
          <% if current_user && current_user.email == "brian@snowschoolers.com" || current_user.user_type == "Snow Schoolers Employee" %>
          <td><%= rental.id %></td>
          <td><%= rental.resource_id ? rental.resource.gb_identifier : "" %></td>
          <% end %>
          <td><%= rental.student.name %></td>
          <td><%= rental.resource_type_text %></td>
          <% if rental.resource_type == 'ski' || rental.resource_type == 'snowboard' %>
          <td><%= rental.resource_id ? rental.resource.board_size : "" %></td>
          <% else %>
          <td><%= rental.resource_id ? rental.resource.boot_size : "" %></td>
          <% end %>
          <td><%= rental.status %></td>
          <td><%= rental.other %></td>
          <% if rental.resource_id %>
          <td><%= link_to 'Change Equipment', edit_rental_path(rental), class: 'btn btn-warning' %></td>
          <% else %>
          <td><%= link_to 'Choose your Equipment', edit_rental_path(rental), class: 'btn btn-primary' %></td>
          <% end %>
          <td><%= link_to 'Cancel Rental', rental, method: :delete, class: 'btn btn-danger', data: { confirm: 'Are you sure?' } %></td>
        </tr>
        <% end %>
      </tbody>
    </table>

    <% end %>

  </div>
</div>